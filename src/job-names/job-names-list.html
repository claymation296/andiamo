<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/paper-styles/color.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-badge/paper-badge.html" >
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../shared-styles.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../../bower_components/geo-location/geo-location.html">
<link rel="import" href="haversine-api.html">
<dom-module id="job-names-list" >
    <template>
        <style>
            :host {
              display: block;
              @apply(--paper-font-common-base);
              font-family: sans-serif;
            }

            .content {
              @apply(--layout-vertical);
              height: 100%;
            }

            #search{
              width: 120px;
              padding-bottom: 10px;
            }

            .main-toolbar {
              background: var(--light-primary-color);
              color: white;
              height: 50px;
              box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.3);
              font-size: 18px;
            }

            #itemsList,
            #selectedItemsList {
              @apply(--layout-flex);
            }

            .item {
              @apply(--layout-horizontal);
              cursor: pointer;
              padding: 16px 22px;
              background-color: white;
              border-bottom: 1px solid #D7CCC8;
            }

            .avatar {
              height: 50px;
              width: 50px;
              border-radius: 20px;
              box-sizing: border-box;
              background-color: #ddd;
            }

            .pad {
              @apply(--layout-flex);
              @apply(--layout-vertical);
              padding: 0 16px;
            }

            .primary {
              font-size: 16px;
            }

            .secondary {
              font-size: 12px;
            }

            paper-item {
              white-space: nowrap;
              cursor: pointer;
              position: relative;
            }

    
            paper-item:hover::after {
              content: "－";
              width: 16px;
              height: 16px;
              display: block;
              border-radius: 50% 50%;
              background-color: var(--google-red-300);
              margin-left: 10px;
              line-height: 16px;
              text-align: center;
              color: white;
              font-weight: bold;
              text-decoration: none;
              position: absolute;
              right: 15px;
              top: calc(50% - 8px);
            }
   
            iron-list {
                @apply(--layout-flex);
            }

        </style>
    <!--        <geo-location on-geo-response="_usersLocation" latitude="{{lat}}"
               longitude="{{lng}}"></geo-location> -->

        <iron-ajax id="jobData" url="{{contacts}}" on-response="_ajaxReady" auto></iron-ajax>
        <app-drawer-layout  fullbleed>
            <div class="content">
              <app-toolbar  class="main-toolbar">
                <div main-title>Job Names</div>


                  <paper-dropdown-menu id="search" label="Filter:">
                    <paper-listbox class="dropdown-content" selected="{{selectedWork}}" attr-for-selected="value" >
                      <paper-item value="Camp Verde">Camp Verde</paper-item>
                      <paper-item value="Boerne">Boerne</paper-item>
                      <paper-item value="Dominion">Dominion</paper-item>
                      <paper-item value="All">All</paper-item>
                    </paper-listbox>
                  </paper-dropdown-menu>
                </app-toolbar>
                  
                <!-- Main List for the items -->
                <iron-list id="itemsList" items="[[data]]"  selected-item="{{selectedItem}}" selection-enabled>
                  <template>
                    <div tabindex$="[[tabIndex]]" aria-label$="Select/Deselect [[item.name]]" class$="[[_computedClass(selected)]]">
                      <img class="avatar" src="[[item.image]]">
                        <div class="pad">
                          <div class="primary">[[item.name]]</div>
                          <div class="secondary dim">[[item.shortText]]</div>
                      </div>
                    </div>
                    <div class="border"></div>
                  </template>
                </iron-list>
            </div>
          </app-drawer-layout>



    </template>

    <script>
      Polymer({
        is: 'job-names-list',
          
          properties: {
            selectedItem: {
            type: Object,
            observer: '_selectedItemChanged'
            },

            selectedWork: {
            type: String,
            observer: '_selectedWorkChanged',
            },
          
          },  


          _computedClass: function(isSelected) {
            var classes = 'item';
            if (isSelected) {
              classes += ' selected';
            }
            return classes;
          },


          _selectedItemChanged: function(selected){
            if (!selected) {return;}
              this.fire('job-names-list-selected-item', {selected}); 
          },

_usersLocation(){
//  const start = {
//               latitude: this.lat,
//               longitude:this.lng
//             }

//             const end = {
//               latitude: this.data[0].latitude,
//               longitude: this.data[0].longitude
//             }

//             console.log(this.data[0].latitude);
//                         console.log(this.data[0].longitude);
//                          console.log(this.lat);
//                         console.log(this.lng);    

// // console.log(haversine(start, end))
// // console.log(haversine(start, end, {unit: 'mile'}))
// // console.log(haversine(start, end, {unit: 'meter'}))
// // console.log(haversine(start, end, {threshold: 1}))
// // console.log(haversine(start, end, {threshold: 400, unit: 'mile'}))
// // console.log(haversine(start, end, {threshold: 1, unit: 'meter'}))       
},
          _ajaxReady: function(event){
            this.data = this.$.jobData.lastResponse;

           
          },


          _selectedWorkChanged: function(selected){
           if (!selected) {return;} 
            if (selected === "All"){
              this.data = this.$.jobData.lastResponse;            
            } else {
              this.data = this.$.jobData.lastResponse.filter((jobType) => jobType.type === selected);
            }
          },

        });

    </script>

</dom-module>